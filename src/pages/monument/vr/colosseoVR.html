<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>VR Experience</title>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <style>
    #exit-button {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      background-color: #FF3366;
      color: white;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      cursor: pointer;
      z-index: 9999;
      border: 2px solid white;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    #exit-button:hover {
      background-color: #FF0033;
    }
    #exit-button.vr-hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="exit-button" class="vr-hidden">X</div>
  
  <a-scene vr-mode-ui="enterVRButton: #enter-vr; exitVRButton: #exit-vr">
    <!-- Skybox -->
    <a-sky src="/src/resources/images/monuments/vr/colosseo/img1.jpg" rotation="0 -90 0"></a-sky>
    
    <!-- Testo -->
    <a-text value="Colosseo" position="-1 1 -3" color="#FFF" align="center" scale="2 2 2"></a-text>
    
    <!-- Camera -->
    <a-entity id="camera" camera look-controls wasd-controls position="0 0 0"></a-entity>
    
    <!-- Pulsante VR per uscita -->
    <a-entity id="exit-vr" 
              position="1 1.5 -2"
              geometry="primitive: box; width: 0.5; height: 0.5; depth: 0.01"
              material="color: #FF3366"
              text="value: Esci; align: center; color: white; width: 0.8"
              look-at="#camera">
      <a-entity position="0 0 0.021" text="value: X; align: center; color: white; width: 0.3"></a-entity>
    </a-entity>
    
    <!-- Pulsante VR per entrata (nascosto) -->
    <a-entity id="enter-vr" visible="false"></a-entity>
  </a-scene>

  <script>
    // Gestione uscita VR
    function exitVR() {
      const scene = document.querySelector('a-scene');
      
      if (scene.is('vr-mode')) {
        const session = scene.renderer.xr.getSession();
        if (session) {
          session.end().then(() => {
            console.log("Sessione VR terminata");
          }).catch(err => {
            console.error("Errore uscita VR:", err);
          });
        }
      }
    }
    
    // Setup pulsanti
    document.addEventListener('DOMContentLoaded', () => {
      const exitButton = document.getElementById('exit-button');
      const exitVRButton = document.getElementById('exit-vr');
      
      // Pulsante 2D
      exitButton.addEventListener('click', exitVR);
      
      // Pulsante VR
      exitVRButton.addEventListener('click', exitVR);
      
      // Gestione visibilitÃ  pulsante 2D
      document.querySelector('a-scene').addEventListener('enter-vr', () => {
        exitButton.classList.add('vr-hidden');
      });
      
      document.querySelector('a-scene').addEventListener('exit-vr', () => {
        exitButton.classList.remove('vr-hidden');
      });
    });
  </script>
</body>
</html>
